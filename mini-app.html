<!DOCTYPE html>
<html>
<head>
    <title>Поиск квартиры</title>
    <style>
        body {
            font-family: sans-serif;
            text-align: center;
        }
        select, input, button {
            margin: 10px;
            padding: 8px;
            font-size: 16px;
        }
        .carousel {
            display: flex;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            width: 100%;
        }
        .carousel-item {
            flex: 0 0 100%;
            scroll-snap-align: start;
            padding: 20px;
            border: 1px solid #ddd;
            margin: 10px;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <h1>Поиск квартиры</h1>
    <label for="city">Город:</label>
    <select id="city">
        <option value="Москва">Москва</option>
        <option value="Екатеринбург">Екатеринбург</option>
        <option value="Санкт-Петербург">Санкт-Петербург</option>
    </select><br>
    <label for="rent">Сумма аренды:</label>
    <input type="number" id="rent"><br>
    <button id="search">Показать квартиры</button>
    <div id="results" class="hidden">
        <h2>Результаты поиска</h2>
        <div class="carousel"></div>
    </div>

   <script>
    const searchButton = document.getElementById('search');
    const resultsDiv = document.getElementById('results');
    const carouselDiv = document.querySelector('.carousel');

    searchButton.addEventListener('click', () => {
        const city = document.getElementById('city').value;
        const rent = parseInt(document.getElementById('rent').value);

        // Замените YOUR_GOOGLE_SHEET_URL на ссылку на вашу таблицу
        const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRzFm-I4hL8tKOSXOsW-yeg4N2-WJfA9aLBXfxf4pF6pvGQFPbnj1fTztVWTQVkS9q-seBCXLMx07Z9/pub?output=tsv';

        fetch(sheetUrl)
            .then(response => response.text())
            .then(data => {
                const rows = data.split('\n');
                let apartments = [];
                for (let i = 1; i < rows.length; i++) {
                    const row = rows[i].split('\t');
                    // Исправлено: преобразование в число и регистр города
                    if (row[5].toLowerCase() === city.toLowerCase() && parseInt(row[0]) <= rent) { 
                        apartments.push({
                            name: row[2],
                            mortgage: row[0],
                            price: row[3],
                            image: row[1]
                        });
                    }
                }

                if (apartments.length > 0) {
                    resultsDiv.classList.remove('hidden');
                    carouselDiv.innerHTML = '';
                    apartments.forEach(apartment => {
                        const item = document.createElement('div');
                        item.classList.add('carousel-item');
                        item.innerHTML = `
                            <h3>${apartment.name}</h3>
                            <p>Ипотека: ${apartment.mortgage}</p>
                            <p>Цена: ${apartment.price}</p>
                            <img src="${apartment.image}" alt="${apartment.name}" style="max-width: 100%;">
                        `;
                        carouselDiv.appendChild(item);
                    });
                } else {
                    resultsDiv.classList.remove('hidden');
                    carouselDiv.innerHTML = '<p>Квартиры не найдены</p>';
                }
            });
    });
</script>
</body>
</html>
